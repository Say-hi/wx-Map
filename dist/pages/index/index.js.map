{"version":3,"sources":["pages/index/index.js"],"names":["app","getApp","bmap","require","wxparse","timer","Page","data","showText","title","dots","circular","autoplay","userInfo","imgMode","show","weatherData","weatherText","zsIcon","changeColor","clearInterval","that","colorArr","setInterval","color_start","color_end","color_center","i","Math","floor","random","setData","rotate","showToast","wx","icon","goToExpress","navigateTo","url","goTodaohang","chooseCity","obj","success","res","site","longitude","latitude","Bmap","cancel","console","log","fail","chooseLocation","_this","BMap","BMapWX","ak","currentWeather","weatherAll","originalData","results","name","array","index","weather","location","getDayNote","date","Date","time","getFullYear","getMonth","getDate","request","method","cc","topDate","setStorageSync","getStorageSync","showShares","canIUse","showShareMenu","image","mask","duration","getIndexData","wxrequest","baseDomain","wxParse","content","indexInfo","shows","onLoad","hour","getHours","curtime","hideindex","onReady","onShow","onHide","onUnload","onPullDownRefresh","setTimeout","stopPullDownRefresh","onShareAppMessage","path"],"mappings":"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","file":"index.js","sourcesContent":["// 获取全局应用程序实例对象\r\n/*eslint-disable*/\r\nconst app = getApp()\r\nconst bmap = require('../../utils/bmap-wx')\r\nconst wxparse = require('../../wxParse/wxParse')\r\nlet timer = null\r\n// 创建页面实例对象\r\nPage({\r\n  /**\r\n   * 页面的初始数据\r\n   */\r\n  data: {\r\n    showText: '体验更多',\r\n    // rotate: 135,\r\n    // color_start: 'fff000',\r\n    // color_center: 'fff000',\r\n    // color_end: 'ff0000',\r\n    title: 'Index page',\r\n    dots: true,\r\n    circular: false,\r\n    autoplay: false,\r\n    userInfo: {},\r\n    imgMode: 'aspectFill',\r\n    show: false,\r\n    weatherData: '',\r\n    weatherText: ['当前城市', 'PM2.5', '日期', '温度', '天气', '风力'],\r\n    zsIcon: ['icon-chuanyikunhuo', 'icon-xiche', 'icon-ganmaozhishu', 'icon-yundong', 'icon-ziwaixian']\r\n  },\r\n  changeColor () {\r\n    if (timer) clearInterval(timer)\r\n    let that = this\r\n    let colorArr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F']\r\n    timer = setInterval(() => {\r\n      let color_start = '',\r\n        color_end = '',\r\n        color_center = ''\r\n      for (let i = 0; i < 6; i++) {\r\n        color_start += colorArr[Math.floor(Math.random() * 16)]\r\n      }\r\n      for (let i = 0; i < 6; i++) {\r\n        color_center += colorArr[Math.floor(Math.random() * 16)]\r\n      }\r\n      for (let i = 0; i < 6; i++) {\r\n        color_end += colorArr[Math.floor(Math.random() * 16)]\r\n      }\r\n      that.setData({\r\n        color_center,\r\n        color_start,\r\n        color_end,\r\n        rotate: Math.floor(Math.random() * 181)\r\n      })\r\n    }, 700)\r\n  },\r\n  showToast () {\r\n    wx.showToast({\r\n      title: '功能开发中...',\r\n      icon: 'loading'\r\n    })\r\n  },\r\n  /**\r\n   * 去到快递查询\r\n   */\r\n  goToExpress () {\r\n    wx.navigateTo({\r\n      url: '../express/express'\r\n    })\r\n  },\r\n  goTodaohang () {\r\n    wx.navigateTo({\r\n      url: '../AppUrl/AppUrl'\r\n    })\r\n  },\r\n  /**\r\n   * 选择城市\r\n   */\r\n  chooseCity () {\r\n    // let obj = {\r\n    //   type: 'gcj02',\r\n    //   success (res) {\r\n    //     console.log(res)\r\n    //   }\r\n    // }\r\n    // wx.getLocation(obj)\r\n    let that = this\r\n    let obj = {\r\n      success (res) {\r\n        // console.log(res)\r\n        let site = res.longitude + ',' + res.latitude\r\n        that.Bmap(that, site)\r\n      },\r\n      cancel (res) {\r\n        console.log(res)\r\n      },\r\n      fail (res) {\r\n        console.log(res)\r\n      }\r\n    }\r\n    wx.chooseLocation(obj)\r\n  },\r\n  /**\r\n   * 百度地图函数\r\n   * @param that\r\n   * @constructor\r\n   */\r\n  Bmap (that, site) {\r\n    // var _this = that\r\n    var _this = this\r\n    var BMap = new bmap.BMapWX({\r\n      ak: 'mIjA3xq45izQn0ej132vqufm3FAvOy4G'\r\n    })\r\n    var fail = function (data) {\r\n      // console.log('fail!!!!')\r\n    }\r\n    var success = function (data) {\r\n      // console.log('success!!!')\r\n      var weatherData = data.currentWeather[0]\r\n      var weatherAll = data.originalData.results[0]\r\n      var name = {}\r\n      var array = that.data.weatherText\r\n      let i = 0\r\n      for (var index in weatherData) {\r\n        name[index] = array[i++]\r\n      }\r\n      that.setData({\r\n        weatherData: weatherData,\r\n        weatherAll: weatherAll,\r\n        name: name\r\n      })\r\n    }\r\n    BMap.weather({\r\n      fail: fail,\r\n      success: success,\r\n      location: site || null\r\n    }, _this)\r\n  },\r\n  // 获取51每日一言数据\r\n  getDayNote () {\r\n    let that = this\r\n    var date = new Date()\r\n    var time = date.getFullYear() + '-' + (date.getMonth() * 1 + 1) + '-' + date.getDate()\r\n    wx.request({\r\n      url: 'https://www.51wnl.com/Api4.3.3/GetSentenceByDate.ashx',\r\n      method: 'GET',\r\n      data: {\r\n        date: time,\r\n        cc: 'cn'\r\n      },\r\n      success (res) {\r\n        that.setData({\r\n          topDate: res.data.data,\r\n          show: true\r\n        })\r\n        wx.setStorageSync('topDate', res.data.data)\r\n      },\r\n      fail () {\r\n        that.setData({\r\n          topDate: wx.getStorageSync('topDate')\r\n        })\r\n        // console.log(res)\r\n      }\r\n    })\r\n  },\r\n  showShares () {\r\n    // wx.showShareMenu()\r\n    if (wx.canIUse('showShareMenu')) {\r\n      // console.log(1)\r\n      wx.showShareMenu()\r\n    } else {\r\n      wx.showToast({\r\n        title: '请小主点击右上角的按钮分享小程序给朋友',\r\n        image: '../../images/keai.png',\r\n        mask: 'true',\r\n        duration: 3000\r\n      })\r\n    }\r\n  },\r\n  // 获取服务器json数据\r\n  getIndexData () {\r\n    var that = this\r\n    app.wxrequest({\r\n      url: app.data.baseDomain + '/api/wechatIndex2.json',\r\n      data: {},\r\n      success (res) {\r\n        wxparse.wxParse('content', 'html',res.data[0].content,that,5)\r\n        that.setData({\r\n          indexInfo: res.data[0],\r\n          shows: res.data[0].show == 1 ? true : false\r\n        })\r\n      }\r\n    })\r\n  },\r\n  /**\r\n   * 生命周期函数--监听页面加载\r\n   */\r\n  onLoad () {\r\n    var date = new Date()\r\n    var hour = date.getHours()\r\n    if (hour >= 18) {\r\n      this.setData({\r\n        curtime: 1 // 晚上\r\n      })\r\n    } else {\r\n      this.setData({\r\n        curtime: 0 // 白天\r\n      })\r\n    }\r\n    this.getIndexData()\r\n    var that = this\r\n    // 百度地图\r\n    that.Bmap(that)\r\n  },\r\n  hideindex () {\r\n    this.setData({\r\n      shows: !this.data.shows\r\n    })\r\n  },\r\n  /**\r\n   * 生命周期函数--监听页面初次渲染完成\r\n   */\r\n  onReady () {\r\n\r\n  },\r\n  /**\r\n   * 生命周期函数--监听页面显示\r\n   */\r\n  onShow () {\r\n    this.changeColor()\r\n    this.getDayNote()\r\n    if (wx.getStorageSync('topDate')) {\r\n      this.setData({\r\n        topDate: wx.getStorageSync('topDate'),\r\n        show: true\r\n      })\r\n    }\r\n    // console.log(' ---------- onShow ----------')\r\n  },\r\n  /**\r\n   * 生命周期函数--监听页面隐藏\r\n   */\r\n  onHide () {\r\n    if (timer) clearInterval(timer)\r\n    // console.log(' ---------- onHide ----------')\r\n  },\r\n  /**\r\n   * 生命周期函数--监听页面卸载\r\n   */\r\n  onUnload () {\r\n    if (timer) clearInterval(timer)\r\n    // console.log(' ---------- onUnload ----------')\r\n  },\r\n  /**\r\n   * 页面相关事件处理函数--监听用户下拉动作\r\n   */\r\n  onPullDownRefresh () {\r\n    // console.log(' ---------- onPullDownRefresh ----------')\r\n    var that = this\r\n    that.Bmap(that)\r\n    this.getIndexData()\r\n    setTimeout(function () {\r\n      wx.stopPullDownRefresh()\r\n    }, 4000)\r\n  },\r\n  onShareAppMessage: function () {\r\n    return {\r\n      title: '向您推荐一个有趣的小程序，快来围观吧',\r\n      path: '/pages/index/index'\r\n    }\r\n  }\r\n})\r\n"]}