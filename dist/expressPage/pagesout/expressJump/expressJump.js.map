{"version":3,"sources":["expressPage/pagesout/expressJump/expressJump.js"],"names":["app","getApp","Page","data","title","callPhone","e","wx","makePhoneCall","phoneNumber","currentTarget","dataset","phone","save","list","getStorageSync","item","nubmer","number","showModal","tilte","content","showCancel","obj","company","expressInfo","logisticCode","traces","db","cloud","database","collection","add","unshift","setStorageSync","onLoad","setData","loading","that","login","then","res","getExpress","acceptStation","result","reg","str","match","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"expressJump.js","sourcesContent":["// 获取全局应用程序实例对象\r\nconst app = getApp()\r\n// 创建页面实例对象\r\nPage({\r\n  /**\r\n   * 页面的初始数据\r\n   */\r\n  data: {\r\n    title: 'expressJump'\r\n  },\r\n  /**\r\n   * 拨打电话\r\n   * @param e\r\n   */\r\n  callPhone (e) {\r\n    // console.log(e)\r\n    // console.log(1)\r\n    wx.makePhoneCall({\r\n      phoneNumber: e.currentTarget.dataset.phone\r\n    })\r\n  },\r\n  /**\r\n   * 存储记录\r\n   */\r\n  save () {\r\n    let list = wx.getStorageSync('saveList') || []\r\n    for (var item in list) {\r\n      if (list[item].nubmer === this.data.number) {\r\n        return wx.showModal({\r\n          tilte: '已有信息',\r\n          content: '亲爱的小主，您已经保存过啦',\r\n          showCancel: false\r\n        })\r\n      }\r\n    }\r\n    let obj = {\r\n      nubmer: this.data.number,\r\n      company: this.data.expressInfo.logisticCode,\r\n      traces: this.data.expressInfo.traces[0]\r\n    }\r\n    const db = wx.cloud.database()\r\n    db.collection('express').add({\r\n      data: {\r\n        nubmer: this.data.number,\r\n        company: this.data.expressInfo.logisticCode,\r\n        traces: this.data.expressInfo.traces[0]\r\n      }\r\n    })\r\n    // console.log(obj)\r\n    list.unshift(obj)\r\n    wx.setStorageSync('saveList', list)\r\n    wx.showModal({\r\n      tilte: '保存成功',\r\n      content: '已保存该快递记录',\r\n      showCancel: false\r\n    })\r\n  },\r\n  /**\r\n   * 生命周期函数--监听页面加载\r\n   */\r\n  onLoad (e) {\r\n    this.setData({\r\n      number: e.number,\r\n      loading: true\r\n    })\r\n    let that = this\r\n    app.cloud().login()\r\n      .then(res => {\r\n        that.setData({\r\n          ...res\r\n        })\r\n      })\r\n    app.cloud().getExpress({number: e.number})\r\n      .then(res => {\r\n        if (!res.data) {\r\n          that.setData({\r\n            loading: false,\r\n            expressInfo: {\r\n              logisticCode: '请检查您的快递单号',\r\n              traces: [{acceptStation: '未查询到该快递单号信息，请检查您的快递单号'}]\r\n            }\r\n          })\r\n        } else {\r\n          let result = res.data\r\n          let reg = /(\\d{11,20})/\r\n          for (let item in result.traces) {\r\n            let str = result.traces[item].acceptStation\r\n            let phone = str.match(reg)\r\n            if (phone) {\r\n              result.traces[item].phone = phone[0]\r\n            }\r\n          }\r\n          that.setData({\r\n            loading: false,\r\n            expressInfo: result\r\n          })\r\n        }\r\n      })\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面初次渲染完成\r\n   */\r\n  onReady () {\r\n    // TODO: onReady\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面显示\r\n   */\r\n  onShow () {\r\n    // TODO: onShow\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面隐藏\r\n   */\r\n  onHide () {\r\n    // TODO: onHide\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面卸载\r\n   */\r\n  onUnload () {\r\n    // TODO: onUnload\r\n  },\r\n\r\n  /**\r\n   * 页面相关事件处理函数--监听用户下拉动作\r\n   */\r\n  onPullDownRefresh () {\r\n    // TODO: onPullDownRefresh\r\n  }\r\n})\r\n"]}